<!DOCTYPE html>
<html lang="en" class="no-js">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="description" content="Mnemosyne is an intelligent conversational search agent, named after the Greek goddess of memory." />
      <meta name="keywords" content="llm, search, rag, ai, knowledge" />
      <meta name="author" content="Mnemosyne" />
      <title>Mnemosyne - Your Knowledge, Personalized</title>
      <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='img/mnemosyne.ico') }}">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/sunburst.min.css"/>
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/search_helper.css') }}" />
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/search_style.css') }}" />
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/sdk-features.css') }}">
      <script>document.documentElement.className = 'js';</script>
   </head>
   <body class="demo-10">
      <svg class="hidden">
         <defs>
            <symbol id="icon-arrow" viewBox="0 0 24 24">
               <title>arrow</title>
               <polygon points="6.3,12.8 20.9,12.8 20.9,11.2 6.3,11.2 10.2,7.2 9,6 3.1,12 9,18 10.2,16.8 "/>
            </symbol>
            <symbol id="icon-drop" viewBox="0 0 24 24">
               <title>drop</title>
               <path d="M12,21c-3.6,0-6.6-3-6.6-6.6C5.4,11,10.8,4,11.4,3.2C11.6,3.1,11.8,3,12,3s0.4,0.1,0.6,0.3c0.6,0.8,6.1,7.8,6.1,11.2C18.6,18.1,15.6,21,12,21zM12,4.8c-1.8,2.4-5.2,7.4-5.2,9.6c0,2.9,2.3,5.2,5.2,5.2s5.2-2.3,5.2-5.2C17.2,12.2,13.8,7.3,12,4.8z"/>
               <path d="M12,18.2c-0.4,0-0.7-0.3-0.7-0.7s0.3-0.7,0.7-0.7c1.3,0,2.4-1.1,2.4-2.4c0-0.4,0.3-0.7,0.7-0.7c0.4,0,0.7,0.3,0.7,0.7C15.8,16.5,14.1,18.2,12,18.2z"/>
            </symbol>
            <symbol id="icon-search" viewBox="0 0 24 24">
               <title>search</title>
               <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
            </symbol>
            <symbol id="icon-cross" viewBox="0 0 24 24">
               <title>cross</title>
               <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
            </symbol>
            <symbol id="icon-images" viewBox="0 0 24 24">
               <title>images</title>
               <rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect>
               <circle cx="9" cy="9" r="2"></circle>
               <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path>
            </symbol>
            <symbol id="icon-answer" viewBox="0 0 24 24">
               <title>answer</title>
               <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path>
               <path d="m9 9.5 2 2 4-4"></path>
            </symbol>
            <symbol id="icon-follow-up" viewBox="0 0 24 24">
               <title>follow-up</title>
               <path d="m2 9 3-3 3 3"></path>
               <path d="M13 18H7a2 2 0 0 1-2-2V6"></path>
               <path d="m22 15-3 3-3-3"></path>
               <path d="M11 6h6a2 2 0 0 1 2 2v10"></path>
            </symbol>
            <symbol id="icon-newspaper" viewBox="0 0 24 24">
               <title>newspaper</title>
               <path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"></path>
               <path d="M18 14h-8"></path>
               <path d="M15 18h-5"></path>
               <path d="M10 6h8v4h-8V6Z"></path>
            </symbol>
            <symbol id="icon-generate" viewBox="0 0 24 26">
               <title>generate</title>
               <path d="M5.16515 2.62145L5.8075 0.999247C5.83876 0.919722 5.9154 0.866699 6.00112 0.866699C6.08683 0.866699 6.16347 0.919722 6.19473 0.999247L6.83708 2.62145L8.44145 3.27094C8.5201 3.30254 8.57254 3.38003 8.57254 3.4667C8.57254 3.55337 8.5201 3.63085 8.44145 3.66246L6.83708 4.31195L6.19473 5.93415C6.16347 6.0147 6.08683 6.0667 6.00112 6.0667C5.9154 6.0667 5.83876 6.0147 5.8075 5.93415L5.16515 4.31195L3.56078 3.66246C3.48112 3.63085 3.42969 3.55337 3.42969 3.4667C3.42969 3.38003 3.48112 3.30254 3.56078 3.27094L5.16515 2.62145Z" />
               <path d="M11.2362 9.43967C11.5502 9.30067 11.8015 9.05025 11.9405 8.73617L13.5494 5.11725C13.7169 4.74204 14.0887 4.5 14.5 4.5C14.9112 4.5 15.2839 4.74204 15.4506 5.11725L17.0603 8.73617C17.1985 9.05025 17.4497 9.3015 17.7638 9.43967L21.3827 11.0494C21.7579 11.2161 22 11.5887 22 12C22 12.4112 21.7579 12.7831 21.3827 12.9506L17.7638 14.5595C17.4497 14.6985 17.1993 14.9497 17.0603 15.2638L15.4506 18.8827C15.2839 19.2579 14.9112 19.5 14.5 19.5C14.0887 19.5 13.7169 19.2579 13.5494 18.8827L11.9405 15.2638C11.8015 14.9497 11.5502 14.6985 11.2362 14.5595L7.61725 12.9506C7.24204 12.7831 7 12.4112 7 12C7 11.5887 7.24204 11.2161 7.61725 11.0494L11.2362 9.43967Z" />
               <path d="M4.60728 19.392L5.67703 16.6875C5.72997 16.5541 5.85854 16.4666 6.00056 16.4666C6.14258 16.4666 6.27031 16.5541 6.32325 16.6875L7.39299 19.392L10.0678 20.4736C10.1997 20.5271 10.2863 20.6563 10.2863 20.7999C10.2863 20.9435 10.1997 21.0735 10.0678 21.1271L7.39299 22.2087L6.32325 24.9123C6.27031 25.0457 6.14258 25.1332 6.00056 25.1332C5.85854 25.1332 5.72997 25.0457 5.67703 24.9123L4.60728 22.2087L1.93333 21.1271C1.8014 21.0735 1.71484 20.9435 1.71484 20.7999C1.71484 20.6563 1.8014 20.5271 1.93333 20.4736L4.60728 19.392Z" />
            </symbol>
            <symbol id="icon-settings" viewBox="0 0 24 24">
               <title>settings</title>
               <circle cx="12" cy="12" r="3"></circle>
               <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </symbol>
            <symbol id="icon-folder" viewBox="0 0 24 24">
               <title>folder</title>
               <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
            </symbol>
            <symbol id="icon-file" viewBox="0 0 24 24">
               <title>file</title>
               <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
               <polyline points="14 2 14 8 20 8"></polyline>
            </symbol>
            <symbol id="icon-plus" viewBox="0 0 24 24">
               <title>plus</title>
               <line x1="12" y1="5" x2="12" y2="19"></line>
               <line x1="5" y1="12" x2="19" y2="12"></line>
            </symbol>
            <symbol id="icon-upload" viewBox="0 0 24 24">
               <title>upload</title>
               <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
               <polyline points="17 8 12 3 7 8"></polyline>
               <line x1="12" y1="3" x2="12" y2="15"></line>
            </symbol>
            <symbol id="icon-key" viewBox="0 0 24 24">
               <title>key</title>
               <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
            </symbol>
         </defs>
      </svg>

      <!-- Left Sidebar - Collections & Documents -->
      <aside id="left-sidebar" class="left-sidebar">
         <div class="sidebar-header">
            <h3>Collections</h3>
            <button id="new-collection-btn" class="icon-btn" title="New Collection">
               <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
                  <use xlink:href="#icon-plus"></use>
               </svg>
            </button>
         </div>
         <div id="collections-list" class="collections-list">
            <div class="empty-state">Create your first collection to start uploading your documents</div>
         </div>
         <div id="documents-section-wrapper" class="documents-section-wrapper">
            <div class="sidebar-divider"></div>
            <div class="sidebar-header">
               <h3>Documents</h3>
               <button id="upload-doc-btn" class="icon-btn" title="Upload Document">
                  <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
                     <use xlink:href="#icon-upload"></use>
                  </svg>
               </button>
            </div>
            <div id="documents-list" class="documents-list">
               <div class="empty-state">Select a collection</div>
            </div>
         </div>
      </aside>

      <!-- Main Content Area -->
      <div class="page with-sidebar">
         <div class="page__single page__single--dummy"></div>
         <div class="page__single page__single--dummy"></div>
         <div class="page__single page__single--dummy"></div>
         <div class="page__single page__single--dummy"></div>
         <main class="main-wrap page__single">
            <header class="codrops-header">
               <div class="query-container">
                  <h1 class="codrops-header__title" id="query"></h1>
               </div>
               <!-- Top right buttons: Search + Settings -->
               <div class="page-header-buttons">
                  <button id="btn-search" class="header-icon-btn" title="New Search">
                     <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                        <use xlink:href="#icon-search"></use>
                     </svg>
                  </button>
                  <button id="page-settings-btn" class="header-icon-btn settings-icon" title="Settings">
                     <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                        <use xlink:href="#icon-settings"></use>
                     </svg>
                  </button>
               </div>
            </header>
            <div id="content-wrapper">
               <div id="main-content">
                  <div class="follow-up-images">
                     <svg class="lucid-images-svg mr-1.5 text-muted-foreground" style="margin-right: 0.375rem; margin-bottom: 0.175rem; display: inline-block; vertical-align: middle; width: 16px; height: 16px;" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <use xlink:href="#icon-images"></use>
                     </svg>
                     <h2 class="lucid-images">Images</h2>
                  </div>
                  <div id="images-section">
                     <button id="more-images" class="more-button" style="display: none;">+</button>
                     <div id="images-container" class="images-container">
                        <div class="image-wrapper"><div class="image-loader"></div></div>
                        <div class="image-wrapper"><div class="image-loader"></div></div>
                        <div class="image-wrapper"><div class="image-loader"></div></div>
                     </div>
                  </div>
                  <div class="follow-up-answer">
                     <svg width="16" height="16" class="lucide lucid-images-svg" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <use xlink:href="#icon-answer"></use>
                     </svg>
                     <h2 class="lucid-images">Answer</h2>
                  </div>
                  <div id="answer-container">
                     <div class="answer-loader"></div>
                  </div>
                  <div class="follow-up-text">
                     <svg width="16" height="16" class="lucide lucid-images-svg" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <use xlink:href="#icon-follow-up"></use>
                     </svg>
                     <h2 class="lucid-images">Follow-up Questions</h2>
                  </div>
                  <div id="follow-up-container">
                     <div class="follow-up-loader"></div>
                     <div class="follow-up-loader"></div>
                  </div>
               </div>
               <div id="sidebar">
                  <div class="follow-up-sources">
                     <svg width="16" height="16" class="lucide lucide-newspaper mr-1.5 text-muted-foreground" style="margin-right: 0.675rem; display: inline-block;" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <use xlink:href="#icon-newspaper"></use>
                     </svg>
                     <h2 class="lucid">Sources</h2>
                  </div>
                  <div id="sources-container">
                     <div class="source-loader"></div>
                     <div class="source-loader"></div>
                  </div>
               </div>
            </div>
         </main>

         <!-- Search Overlay -->
         <div class="search">
            <img class="codrops-icon codrops-icon--prev logo" src="../static/img/mn-purple.png" alt="logo">

            <!-- Settings Button (search overlay) -->
            <button id="overlay-settings-btn" class="header-icon-btn settings-icon overlay-settings" title="Settings">
               <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                  <use xlink:href="#icon-settings"></use>
               </svg>
            </button>

            <button id="btn-search-close" class="btn btn--search-close" aria-label="Close search form">
               <svg class="icon icon--cross">
                  <use xlink:href="#icon-cross"></use>
               </svg>
            </button>
            <div class="search__form Mnemosyne">
               <h1>Mnemosyne</h1>
               <p class="tagline">Conversations that Illuminate: Your Knowledge, Personalized</p>
            </div>
            <div id="search-box" class="search__form search-container">
               <input type="text" class="search__input" id="search-input" placeholder="Type here to search knowledge...">
               <button class="generate-button search-app" id="search-button" onclick="performSearch()">
                  <svg class="icon">
                     <use xlink:href="#icon-generate"></use>
                  </svg>
                  <span>Search</span>
               </button>
            </div>

            <!-- First Time / API Key Setup -->
            <div id="setup-section" class="search__related search__form">
               <div class="search__suggestion setup-card">
                  <div id="setup-not-configured">
                     <h3 class="circularspotifytext-bold-white-20px">First time here?</h3>
                     <p class="circularspotifytext-book-normal-silver-18px">Click the Settings icon to configure your API key and get started.</p>
                  </div>
                  <div id="setup-configured" style="display: none;">
                     <h3 class="circularspotifytext-bold-white-20px">Ready to search!</h3>
                     <p class="circularspotifytext-book-normal-silver-18px">Your knowledge base is configured. Ask me anything!</p>
                  </div>
               </div>
            </div>

         </div>
      </div>

      <!-- Settings Modal -->
      <div id="settings-modal" class="modal-overlay" style="display: none;">
         <div class="modal-content settings-modal">
            <div class="modal-header">
               <button class="close-btn" onclick="closeSettingsModal()">&times;</button>
               <h2>Settings</h2>
            </div>
            <div class="modal-body">
               <div class="settings-section">
                  <h3>API Configuration</h3>
                  <div id="api-status" class="api-status">
                     <span class="status-dot"></span>
                     <span class="status-text">Checking...</span>
                  </div>
                  <div class="form-group">
                     <label>API Key</label>
                     <div class="input-with-btn">
                        <input type="password" id="api-key-input" placeholder="mn_prod_..." class="form-input">
                        <button onclick="toggleApiKeyVisibility()" class="icon-btn-small">Show</button>
                     </div>
                  </div>
                  <button id="save-api-key-btn" class="primary-btn">Save API Key</button>
               </div>
               <div class="settings-divider"></div>
               <div class="settings-section">
                  <h3>Generate New API Key</h3>
                  <p class="hint-text">Register a new account to get an API key</p>
                  <div class="form-group">
                     <label>Email</label>
                     <input type="email" id="register-email" placeholder="your@email.com" class="form-input">
                  </div>
                  <div class="form-group">
                     <label>Password</label>
                     <input type="password" id="register-password" placeholder="Choose a password" class="form-input">
                  </div>
                  <button id="register-btn" class="secondary-btn">Register & Generate Key</button>
               </div>
            </div>
         </div>
      </div>

      <!-- Upload Modal -->
      <div id="upload-modal" class="modal-overlay" style="display: none;">
         <div class="modal-content upload-modal">
            <div class="modal-header">
               <button class="close-btn" onclick="closeUploadModal()">&times;</button>
               <h2>Upload Documents</h2>
            </div>
            <div class="modal-body">
               <div class="upload-dropzone" id="upload-dropzone">
                  <svg width="48" height="48" fill="none" stroke="currentColor" stroke-width="1.5">
                     <use xlink:href="#icon-upload"></use>
                  </svg>
                  <p>Drop and drop or browse files</p>
                  <span class="hint-text">Maximum 500 MB file size</span>
                  <input type="file" id="file-input" accept=".pdf,.docx,.txt,.pptx,.png,.jpg,.jpeg,.webp,.mp3,.wav,.m4a,.xlsx,.xls" multiple hidden>
               </div>
               <div id="upload-queue" class="upload-queue"></div>
               <div class="upload-divider">OR</div>
               <div class="form-group">
                  <label>Upload from URL</label>
                  <div class="input-with-btn">
                     <input type="text" id="url-input" placeholder="https://example.com or YouTube URL" class="form-input">
                     <button id="url-upload-btn" class="primary-btn-small">Add</button>
                  </div>
               </div>
            </div>
         </div>
      </div>

      <!-- New Collection Modal -->
      <div id="collection-modal" class="modal-overlay" style="display: none;">
         <div class="modal-content small-modal">
            <div class="modal-header">
               <button class="close-btn" onclick="closeCollectionModal()">&times;</button>
               <h2>New Collection</h2>
            </div>
            <div class="modal-body">
               <div class="form-group">
                  <label>Collection Name</label>
                  <input type="text" id="collection-name" placeholder="My Knowledge Base" class="form-input">
               </div>
               <div class="form-group">
                  <label>Description (optional)</label>
                  <input type="text" id="collection-desc" placeholder="A brief description" class="form-input">
               </div>
               <button id="create-collection-btn" class="primary-btn full-width">Create Collection</button>
            </div>
         </div>
      </div>

      <!-- Notification Container -->
      <div id="notification-container" class="notification-container"></div>

      <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
      <script src="https://unpkg.co/gsap@3/dist/gsap.min.js"></script>
      <script src="{{ url_for('static', filename='js/search_transform.js') }}"></script>
      <script src="{{ url_for('static', filename='js/script.js') }}"></script>
      <script src="{{ url_for('static', filename='js/sdk-features.js') }}"></script>
   </body>
</html>
